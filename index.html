<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="mobile-web-app-capable" content="yes"/>
<title>Gayatri Jewellers</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, onValue, set, push, remove, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  // â•â• PASTE YOUR FIREBASE CONFIG HERE â•â•
  const firebaseConfig = {
    apiKey: "AIzaSyD8qXLnILIfXGN8Z7POPAS9TngdTAgoKT8",
    authDomain: "gayatri-jewellers-ac7a9.firebaseapp.com",
    databaseURL: "https://gayatri-jewellers-ac7a9-default-rtdb.firebaseio.com",
    projectId: "gayatri-jewellers-ac7a9",
    storageBucket: "gayatri-jewellers-ac7a9.appspot.com",
    messagingSenderId: "910567295800",
    appId: "1:910567295800:web:7166b4284906bb66eacfcd"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  window._db = db;
  window._ref = ref;
  window._onValue = onValue;
  window._set = set;
  window._push = push;
  window._remove = remove;
  window._get = get;
  window._firebaseReady = true;
  document.dispatchEvent(new Event('firebase-ready'));
</script>

<style>
:root {
  --gold:#B8960C; --gold2:#D4A820; --gold3:#F0D060; --goldpale:#FDF6DC;
  --dark:#1C1205; --brown:#3D2A0E; --mid:#6B5030; --muted:#9C845A;
  --cream:#FDFAF3; --white:#FFFFFF; --border:#E8D898; --bg:#FAF7EE;
  --red:#C0392B; --green:#1A6B35;
  --shadow:0 2px 16px rgba(184,150,12,0.10);
  --shadow2:0 6px 32px rgba(184,150,12,0.16);
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--dark);max-width:480px;margin:0 auto;display:flex;flex-direction:column;}
h1,h2,h3,h4,h5{font-family:'Cormorant Garamond',serif;}

/* â”€â”€ LOADING â”€â”€ */
#loading{position:fixed;inset:0;background:var(--cream);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;gap:16px;}
.loading-ring{width:56px;height:56px;border-radius:50%;border:3px solid var(--goldpale);border-top-color:var(--gold);animation:spin 0.8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.loading-text{font-family:'Cormorant Garamond',serif;font-size:20px;color:var(--gold);letter-spacing:1px;}

/* â”€â”€ LOGIN â”€â”€ */
#login-screen{display:none;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:24px;background:linear-gradient(155deg,#FDFAF3 0%,#F7EDD5 50%,#EFE0C0 100%);}
.login-card{background:#fff;border-radius:24px;padding:44px 32px;width:100%;max-width:360px;text-align:center;border:1px solid var(--border);box-shadow:var(--shadow2);}
.logo-circle{width:78px;height:78px;border-radius:50%;background:linear-gradient(135deg,#B8960C,#E8C840);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:32px;color:#fff;box-shadow:0 6px 24px rgba(184,150,12,0.35);}
.brand{font-size:28px;font-weight:700;color:var(--dark);margin-bottom:5px;}
.tagline-text{font-size:10px;color:var(--gold);letter-spacing:4px;margin-bottom:24px;}
.divider-gold{height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:0 0 22px;}
.code-label{font-size:11px;color:var(--muted);letter-spacing:1.5px;margin-bottom:10px;}
.pass-input{width:100%;border:1.5px solid var(--border);border-radius:10px;padding:13px;font-size:20px;outline:none;background:var(--cream);font-family:monospace;letter-spacing:6px;text-align:center;transition:border 0.2s;}
.pass-input:focus{border-color:var(--gold);}
.err-text{color:var(--red);font-size:12px;margin-top:8px;min-height:18px;}
.enter-btn{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#fff;border:none;border-radius:10px;padding:14px;font-size:15px;font-weight:600;cursor:pointer;width:100%;margin-top:14px;letter-spacing:1px;font-family:'DM Sans',sans-serif;box-shadow:0 4px 14px rgba(184,150,12,0.30);transition:transform 0.1s;}
.enter-btn:active{transform:scale(0.98);}
.sync-note{font-size:11px;color:#C8B060;margin-top:22px;opacity:0.85;}

/* â”€â”€ APP SHELL â”€â”€ */
#app-shell{display:none;flex-direction:column;height:100vh;overflow:hidden;}
.top-bar{background:#fff;border-bottom:1px solid var(--border);padding:10px 16px;display:flex;justify-content:space-between;align-items:center;flex-shrink:0;box-shadow:0 1px 6px rgba(184,150,12,0.07);}
.top-left{display:flex;align-items:center;gap:10px;}
.top-icon{font-size:22px;color:var(--gold);}
.top-brand-name{font-family:'Cormorant Garamond',serif;font-size:18px;font-weight:700;color:var(--dark);line-height:1.1;}
.top-brand-sub{font-size:9px;color:var(--muted);letter-spacing:2.5px;}
.top-right{display:flex;gap:8px;align-items:center;}
.mode-pill{border-radius:20px;padding:3px 11px;font-size:10px;font-weight:700;letter-spacing:0.5px;color:#fff;}
.owner-pill{background:var(--dark);}
.staff-pill{background:var(--gold);}
.exit-btn{background:none;border:1px solid #DDD;border-radius:6px;padding:4px 10px;font-size:11px;cursor:pointer;color:#999;font-family:'DM Sans',sans-serif;}

.main-scroll{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;}
.screen-pad{padding:16px;}

.bottom-nav{background:#fff;border-top:1px solid var(--border);display:flex;flex-shrink:0;box-shadow:0 -1px 8px rgba(184,150,12,0.08);}
.nav-btn{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px 2px;background:none;border:none;border-top:2.5px solid transparent;cursor:pointer;color:var(--muted);gap:1px;font-family:'DM Sans',sans-serif;transition:color 0.15s;}
.nav-btn.active{color:var(--gold);border-top-color:var(--gold);}
.nav-icon{font-size:18px;}
.nav-label{font-size:9px;font-weight:500;letter-spacing:0.2px;}

/* â”€â”€ SCREENS â”€â”€ */
.screen{display:none;}
.screen.active{display:block;}
.page-title{font-size:22px;font-weight:700;color:var(--dark);margin-bottom:16px;}

/* â”€â”€ CARDS â”€â”€ */
.card{background:#fff;border-radius:14px;padding:16px;margin-bottom:12px;border:1px solid var(--border);box-shadow:var(--shadow);}
.card-title{font-family:'Cormorant Garamond',serif;font-size:16px;font-weight:700;color:var(--dark);margin-bottom:12px;}

/* â”€â”€ FORMS â”€â”€ */
.fl{font-size:11px;color:var(--muted);margin-bottom:3px;margin-top:10px;letter-spacing:0.5px;display:block;}
.fi{width:100%;border:1px solid #DDD;border-radius:8px;padding:9px 12px;font-size:14px;outline:none;background:var(--cream);font-family:'DM Sans',sans-serif;transition:border 0.2s;margin-bottom:2px;}
.fi:focus{border-color:var(--gold);}
select.fi{cursor:pointer;}
textarea.fi{resize:vertical;min-height:60px;}

/* â”€â”€ BUTTONS â”€â”€ */
.btn-gold{background:linear-gradient(135deg,var(--gold),var(--gold2));color:#fff;border:none;border-radius:10px;padding:11px 20px;font-size:14px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;box-shadow:0 3px 10px rgba(184,150,12,0.25);transition:transform 0.1s,opacity 0.2s;}
.btn-gold:active{transform:scale(0.98);}
.btn-gold:disabled{opacity:0.45;cursor:not-allowed;}
.btn-outline{background:none;border:1.5px solid var(--gold);color:var(--gold);border-radius:10px;padding:9px 16px;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;}
.btn-danger{background:none;border:1.5px solid var(--red);color:var(--red);border-radius:10px;padding:9px 16px;font-size:13px;font-weight:600;cursor:pointer;font-family:'DM Sans',sans-serif;}

/* â”€â”€ RATES BANNER â”€â”€ */
.rates-banner{background:#fff;border-radius:14px;padding:12px 10px;margin-bottom:12px;border:1px solid var(--border);display:flex;justify-content:space-around;flex-wrap:wrap;gap:6px;box-shadow:var(--shadow);}
.rc{text-align:center;min-width:50px;}
.rc-label{font-size:9px;color:var(--muted);letter-spacing:1px;margin-bottom:2px;}
.rc-val{font-size:12px;font-weight:700;color:var(--dark);}

/* â”€â”€ AUTOCOMPLETE â”€â”€ */
.ac-wrap{position:relative;}
.ac-drop{position:absolute;top:calc(100% + 2px);left:0;right:0;background:#fff;border-radius:10px;border:1px solid var(--border);z-index:300;box-shadow:0 6px 24px rgba(0,0,0,0.1);max-height:260px;overflow-y:auto;display:none;}
.ac-drop.open{display:block;}
.ac-item{padding:10px 14px;cursor:pointer;border-bottom:1px solid #F8F0E0;display:flex;align-items:center;gap:8px;}
.ac-item:last-child{border-bottom:none;}
.ac-item:active{background:var(--goldpale);}
.ac-tag{font-weight:700;color:var(--gold);font-size:13px;}
.ac-name{color:var(--muted);font-size:12px;}
.ac-thumb{width:36px;height:36px;border-radius:6px;object-fit:cover;flex-shrink:0;border:1px solid var(--border);}

/* â”€â”€ INVENTORY LIST â”€â”€ */
.inv-card{background:#fff;border-radius:12px;padding:12px;margin-bottom:10px;border:1px solid var(--border);}
.inv-photo{width:68px;height:68px;border-radius:8px;object-fit:cover;border:1px solid var(--border);flex-shrink:0;}
.inv-name{font-weight:700;font-size:14px;color:var(--dark);}
.inv-tag{font-size:12px;color:var(--gold);font-weight:600;}
.inv-meta{font-size:11px;color:var(--muted);}
.inv-price{font-weight:700;color:var(--gold);font-size:15px;font-family:'Cormorant Garamond',serif;}

/* â”€â”€ FILTER CHIPS â”€â”€ */
.chips{display:flex;gap:6px;overflow-x:auto;margin-bottom:12px;padding-bottom:2px;scrollbar-width:none;}
.chips::-webkit-scrollbar{display:none;}
.chip{background:#F5EDD0;border:1px solid var(--border);border-radius:20px;padding:5px 14px;font-size:11px;cursor:pointer;white-space:nowrap;color:var(--mid);font-family:'DM Sans',sans-serif;flex-shrink:0;}
.chip.active{background:var(--gold);color:#fff;border-color:var(--gold);}

/* â”€â”€ PRICE ROW â”€â”€ */
.pr{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px dotted var(--border);}
.pr-label{font-size:13px;color:var(--mid);}
.pr-val{font-size:13px;color:var(--dark);font-weight:500;}

/* â”€â”€ NOTIFICATION â”€â”€ */
.notif{position:fixed;top:70px;left:50%;transform:translateX(-50%) translateY(-20px);background:var(--green);color:#fff;padding:10px 20px;border-radius:30px;font-size:13px;font-weight:600;z-index:9999;opacity:0;transition:all 0.3s;pointer-events:none;white-space:nowrap;}
.notif.show{opacity:1;transform:translateX(-50%) translateY(0);}

/* â”€â”€ TABLE â”€â”€ */
.tbl{width:100%;border-collapse:collapse;font-size:12px;}
.tbl th{text-align:left;padding:6px 8px;color:var(--muted);font-weight:600;border-bottom:1px solid var(--border);}
.tbl td{padding:6px 8px;color:var(--dark);border-bottom:1px solid #F8F0E0;}
.tbl td:not(:first-child){text-align:center;}
.tbl th:not(:first-child){text-align:center;}

/* â”€â”€ BILL DONE â”€â”€ */
.bill-success{text-align:center;padding:32px 16px;}
.success-check{font-size:64px;color:var(--green);margin-bottom:12px;}
.success-amount{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:700;color:var(--gold);margin:14px 0;}

/* â”€â”€ CUSTOMER FULLSCREEN VIEW â”€â”€ */
#customer-view{display:none;position:fixed;inset:0;background:linear-gradient(160deg,#FDFAF3,#F7EDD5 50%,#EFE0C0);z-index:500;overflow-y:auto;flex-direction:column;}
#customer-view.open{display:flex;}
.cv-header{background:linear-gradient(135deg,#1C1205,#3D2A0E);padding:28px 20px 20px;text-align:center;position:relative;}
.cv-close{position:absolute;top:14px;right:14px;background:rgba(255,255,255,0.12);border:none;color:#fff;border-radius:50%;width:36px;height:36px;font-size:20px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
.cv-logo-icon{font-size:26px;color:var(--gold3);margin-bottom:6px;}
.cv-brand{font-family:'Cormorant Garamond',serif;font-size:22px;color:#fff;font-weight:700;}
.cv-tagline{font-size:9px;color:var(--gold3);letter-spacing:3px;margin-top:4px;}
.cv-body{padding:20px;flex:1;}
.cv-product-img{width:100%;max-height:240px;object-fit:cover;border-radius:16px;border:3px solid var(--border);margin-bottom:20px;box-shadow:0 8px 24px rgba(0,0,0,0.12);}
.cv-product-name{font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:700;color:var(--dark);margin-bottom:4px;}
.cv-product-tag{font-size:13px;color:var(--gold);font-weight:600;margin-bottom:4px;}
.cv-product-meta{font-size:12px;color:var(--muted);margin-bottom:20px;}
.cv-section{background:#fff;border-radius:16px;padding:18px;margin-bottom:16px;border:1px solid var(--border);box-shadow:var(--shadow);}
.cv-section-title{font-family:'Cormorant Garamond',serif;font-size:14px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--goldpale);}
.cv-row{display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px dotted #EED898;}
.cv-row:last-child{border-bottom:none;}
.cv-row-label{font-size:13px;color:var(--mid);}
.cv-row-val{font-size:13px;color:var(--dark);font-weight:500;}
.cv-total-box{background:linear-gradient(135deg,#1C1205,#3D2A0E);border-radius:16px;padding:20px;text-align:center;margin-bottom:16px;}
.cv-total-label{font-size:11px;color:var(--gold3);letter-spacing:2px;margin-bottom:6px;}
.cv-total-amount{font-family:'Cormorant Garamond',serif;font-size:36px;font-weight:700;color:#fff;}
.cv-footer{text-align:center;padding:0 20px 28px;color:var(--muted);font-size:11px;line-height:1.8;}
.cv-footer strong{color:var(--gold);font-family:'Cormorant Garamond',serif;font-size:13px;}

/* â”€â”€ ACCESS DENIED â”€â”€ */
.access-denied{text-align:center;padding:70px 20px;}
.denied-icon{font-size:56px;margin-bottom:14px;}
.denied-title{font-size:20px;color:var(--dark);margin-bottom:8px;}
.denied-text{font-size:13px;color:var(--muted);line-height:1.6;margin-bottom:24px;}

/* â”€â”€ WARNING BANNER â”€â”€ */
.warn-banner{background:#FFF8E7;border:1px solid #F0C040;border-radius:10px;padding:12px 14px;margin-bottom:12px;display:flex;align-items:center;gap:10px;}
.warn-text{font-size:13px;color:#8A6A0A;}

/* â”€â”€ NW INFO BOX â”€â”€ */
.nw-box{background:var(--goldpale);border-radius:8px;padding:10px 12px;font-size:13px;color:var(--mid);margin:6px 0 8px;}
.nw-box strong{color:var(--brown);}

/* â”€â”€ REPORT PERIOD BTNS â”€â”€ */
.period-btns{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px;}
.period-btn{background:#F5EDD0;border:1px solid var(--border);border-radius:20px;padding:5px 14px;font-size:11px;cursor:pointer;color:var(--mid);font-family:'DM Sans',sans-serif;}
.period-btn.active{background:var(--gold);color:#fff;border-color:var(--gold);}

/* â”€â”€ PHOTO PREVIEW â”€â”€ */
.photo-preview{width:90px;height:90px;object-fit:cover;border-radius:8px;border:1px solid var(--border);margin-top:6px;display:none;}

/* â”€â”€ SETUP GUIDE â”€â”€ */
.setup-card{background:linear-gradient(135deg,#FDF6DC,#FFF8E7);border:1px solid #E8C840;border-radius:14px;padding:18px;margin-bottom:14px;}
.setup-step{display:flex;gap:12px;margin-bottom:12px;align-items:flex-start;}
.step-num{background:var(--gold);color:#fff;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;margin-top:1px;}
.step-text{font-size:13px;color:var(--brown);line-height:1.5;}

/* â”€â”€ MISC â”€â”€ */
.flex-row{display:flex;align-items:center;gap:8px;}
.flex-between{display:flex;justify-content:space-between;align-items:center;}
.text-gold{color:var(--gold);}
.text-muted{color:var(--muted);}
.text-center{text-align:center;}
.mt8{margin-top:8px;}
.mt12{margin-top:12px;}
.mb0{margin-bottom:0;}
.full-width{width:100%;}
.bold{font-weight:700;}
.serif{font-family:'Cormorant Garamond',serif;}
.empty-state{text-align:center;padding:40px 20px;color:#CCC;}
.empty-icon{font-size:44px;margin-bottom:10px;}
.firebase-setup{padding:16px;}
</style>
</head>
<body>

<!-- LOADING -->
<div id="loading">
  <div class="loading-ring"></div>
  <div class="loading-text">Gayatri Jewellers</div>
</div>

<!-- LOGIN -->
<div id="login-screen">
  <div class="login-card">
    <div class="logo-circle">âœ¦</div>
    <h1 class="brand">Gayatri Jewellers</h1>
    <p class="tagline-text">TRUST Â· PURITY Â· ELEGANCE</p>
    <div class="divider-gold"></div>
    <p class="code-label">ENTER ACCESS CODE</p>
    <input class="pass-input" type="password" id="pass-input" placeholder="Password" autocomplete="off"/>
    <div class="err-text" id="err-text"></div>
    <button class="enter-btn" onclick="doLogin()">ENTER</button>
    <p class="sync-note">âœ¦ Syncs live across all your devices âœ¦</p>
  </div>
</div>

<!-- APP SHELL -->
<div id="app-shell">
  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="top-left">
      <span class="top-icon">âœ¦</span>
      <div>
        <div class="top-brand-name">Gayatri Jewellers</div>
        <div class="top-brand-sub">TRUST Â· PURITY Â· ELEGANCE</div>
      </div>
    </div>
    <div class="top-right">
      <span class="mode-pill" id="mode-pill">OWNER</span>
      <button class="exit-btn" onclick="doLogout()">Exit</button>
    </div>
  </div>

  <!-- MAIN SCROLL -->
  <div class="main-scroll">

    <!-- DASHBOARD -->
    <div class="screen active screen-pad" id="screen-dashboard">
      <div id="dash-rates-banner" class="rates-banner"></div>
      <div id="dash-warn" class="warn-banner" style="display:none">
        <span>âš ï¸</span><span class="warn-text">Rates not set. <span id="dash-set-rates-link" style="color:var(--gold);cursor:pointer;font-weight:600;" onclick="goScreen('rates')">Set today's rates â†’</span></span>
      </div>
      <div id="dash-stats" class="stats-row" style="display:none"></div>
      <div id="dash-stock" class="card" style="display:none">
        <div class="card-title">Stock Summary</div>
        <table class="tbl" id="dash-stock-table"><thead><tr><th>Category</th><th>Pcs</th><th>Grams</th></tr></thead><tbody></tbody></table>
      </div>
      <div class="quick-grid" id="dash-quick"></div>
    </div>

    <!-- LOOKUP -->
    <div class="screen screen-pad" id="screen-lookup">
      <h2 class="page-title">Tag Lookup</h2>
      <div class="ac-wrap">
        <input class="fi" id="lookup-input" placeholder="Type tag e.g. RGS, LDR, CHâ€¦ (autocomplete)" oninput="lookupAC()" autocomplete="off"/>
        <div class="ac-drop" id="lookup-drop"></div>
      </div>
      <div id="lookup-result"></div>
    </div>

    <!-- BILLING -->
    <div class="screen screen-pad" id="screen-billing">
      <h2 class="page-title">Billing</h2>
      <div id="billing-content"></div>
    </div>

    <!-- INVENTORY -->
    <div class="screen screen-pad" id="screen-inventory">
      <div id="inventory-content"></div>
    </div>

    <!-- RATES -->
    <div class="screen screen-pad" id="screen-rates">
      <h2 class="page-title">Today's Rates</h2>
      <div class="card">
        <label class="fl">24kt Gold Rate (â‚¹/gram)</label>
        <input class="fi" type="number" id="rate-gold24" placeholder="e.g. 7200"/>
        <label class="fl">Silver Rate (â‚¹/gram)</label>
        <input class="fi" type="number" id="rate-silver" placeholder="e.g. 90"/>
        <div id="rates-preview" style="display:none;background:var(--goldpale);border-radius:10px;padding:12px;margin:10px 0;">
          <div style="font-size:10px;color:var(--muted);letter-spacing:1px;margin-bottom:8px;">AUTO-CALCULATED RATES</div>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;" id="rates-preview-grid"></div>
        </div>
        <button class="btn-gold full-width mt12" id="save-rates-btn" onclick="saveRates()" style="padding:13px;">Save Rates</button>
      </div>
    </div>

    <!-- REPORTS -->
    <div class="screen screen-pad" id="screen-reports">
      <h2 class="page-title">Reports</h2>
      <div class="period-btns" id="period-btns"></div>
      <div id="reports-content"></div>
    </div>

    <!-- ADD/EDIT ITEM -->
    <div class="screen screen-pad" id="screen-add-item">
      <div id="add-item-content"></div>
    </div>

  </div><!-- end main-scroll -->

  <!-- BOTTOM NAV -->
  <div class="bottom-nav" id="bottom-nav"></div>
</div>

<!-- CUSTOMER FULLSCREEN VIEW -->
<div id="customer-view">
  <div class="cv-header">
    <button class="cv-close" onclick="closeCustomerView()">âœ•</button>
    <div class="cv-logo-icon">âœ¦</div>
    <div class="cv-brand">Gayatri Jewellers</div>
    <div class="cv-tagline">TRUST Â· PURITY Â· ELEGANCE</div>
  </div>
  <div class="cv-body" id="cv-body"></div>
  <div class="cv-footer">
    <strong>Gayatri Jewellers</strong><br/>
    BIS Hallmarked Â· Certified Purity Â· Transparent Pricing<br/>
    Every piece crafted with trust, purity and elegance.
  </div>
</div>

<!-- NOTIFICATION -->
<div class="notif" id="notif"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONSTANTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const OWNER_PASS = "GJISKING001";
const STAFF_PASS = "GJ888826";
const CATS = ["Ladies Ring","Gents Ring","Ladies Set","Earrings","Necklace","Chain","Bracelet","Bangle","Pendant","Mangalsutra","Anklet","Nosering","Other"];
const TYPES = ["22kt Plain","22kt Stone","18kt Diamond","14kt Diamond"];
const PERIODS = ["daily","weekly","monthly","quarterly","yearly"];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let mode = null;
let currentScreen = "dashboard";
let inventory = {};
let rates = { gold24: 0, silver: 0 };
let sales = {};
let editingItemKey = null;
let billingCart = [];
let reportPeriod = "daily";
let firebaseOk = false;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FIREBASE INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initFirebase() {
  if (!window._firebaseReady) {
    document.addEventListener('firebase-ready', () => { firebaseOk = true; listenData(); });
  } else { firebaseOk = true; listenData(); }
}

function listenData() {
  if (!firebaseOk || !window._db) return;
  const db = window._db;
  window._onValue(window._ref(db, 'inventory'), snap => {
    inventory = snap.val() || {};
    if (currentScreen === 'dashboard') renderDashboard();
    if (currentScreen === 'inventory') renderInventoryList();
    if (currentScreen === 'lookup') renderLookupResult(document.getElementById('lookup-input').value);
    if (currentScreen === 'reports') renderReports();
  });
  window._onValue(window._ref(db, 'rates'), snap => {
    rates = snap.val() || { gold24: 0, silver: 0 };
    document.getElementById('rate-gold24').value = rates.gold24 || '';
    document.getElementById('rate-silver').value = rates.silver || '';
    updateRatesPreview();
    renderDashboard();
    if (currentScreen === 'inventory') renderInventoryList();
  });
  window._onValue(window._ref(db, 'sales'), snap => {
    sales = snap.val() || {};
    if (currentScreen === 'reports') renderReports();
    if (currentScreen === 'dashboard') renderDashboard();
  });
}

function dbSet(path, val) {
  if (!firebaseOk) return Promise.resolve();
  return window._set(window._ref(window._db, path), val);
}
function dbPush(path, val) {
  if (!firebaseOk) return Promise.resolve();
  return window._push(window._ref(window._db, path), val);
}
function dbRemove(path) {
  if (!firebaseOk) return Promise.resolve();
  return window._remove(window._ref(window._db, path));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function inr(n) {
  return 'â‚¹' + Number(n || 0).toLocaleString('en-IN', { maximumFractionDigits: 2 });
}
function calcRates(g24) {
  return { r24: g24, r22: +(g24 * 0.945).toFixed(2), r18: +(g24 * 0.785).toFixed(2), r14: +(g24 * 0.62).toFixed(2) };
}
function ctToG(ct) { return +((ct || 0) * 0.2).toFixed(4); }
function calcNW(gw, dCt, sCt) { return +(gw - ctToG(dCt) - ctToG(sCt)).toFixed(4); }

function calcPrice(item) {
  if (!rates.gold24) return null;
  const r = calcRates(rates.gold24);
  const gw = parseFloat(item.gw) || 0;
  const nw = parseFloat(item.nw) || gw;
  const polish = parseFloat(item.polishPct) || 0;
  const mkPG = parseFloat(item.makingPG) || 0;
  const stChg = parseFloat(item.stoneChg) || 0;
  const dChg = parseFloat(item.diamondChg) || 0;
  const dCt = parseFloat(item.diamondCt) || 0;
  const sCt = parseFloat(item.stoneCt) || 0;

  let goldRate, baseW;
  if (item.type === "22kt Plain") { goldRate = r.r22; baseW = gw; }
  else if (item.type === "22kt Stone") { goldRate = r.r22; baseW = nw; }
  else if (item.type === "18kt Diamond") { goldRate = r.r18; baseW = nw; }
  else { goldRate = r.r14; baseW = nw; }

  const billW = +(baseW * (1 + polish / 100)).toFixed(4);
  const goldVal = +(billW * goldRate).toFixed(2);
  const making = +(gw * mkPG).toFixed(2);
  let stoneVal = 0, diamVal = 0;
  if (item.type === "22kt Stone") stoneVal = +(ctToG(sCt) * stChg).toFixed(2);
  if (item.type === "18kt Diamond" || item.type === "14kt Diamond") {
    diamVal = +(dCt * dChg).toFixed(2);
    if (sCt > 0) stoneVal = +(sCt * stChg).toFixed(2);
  }
  return { goldVal, making, stoneVal, diamVal, total: +(goldVal + making + stoneVal + diamVal).toFixed(2), goldRate, billW, baseW };
}

function notify(msg, isError) {
  const el = document.getElementById('notif');
  el.textContent = msg;
  el.style.background = isError ? 'var(--red)' : 'var(--green)';
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 2800);
}

function showEl(id) { document.getElementById(id).style.display = ''; }
function hideEl(id) { document.getElementById(id).style.display = 'none'; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LOGIN / LOGOUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('pass-input').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

function doLogin() {
  const p = document.getElementById('pass-input').value.trim();
  if (p === OWNER_PASS) { mode = 'owner'; startApp(); }
  else if (p === STAFF_PASS) { mode = 'staff'; startApp(); }
  else { document.getElementById('err-text').textContent = 'Incorrect password. Try again.'; document.getElementById('pass-input').value = ''; }
}

function startApp() {
  document.getElementById('login-screen').style.display = 'none';
  document.getElementById('app-shell').style.display = 'flex';
  document.getElementById('mode-pill').textContent = mode === 'owner' ? 'OWNER' : 'STAFF';
  document.getElementById('mode-pill').className = 'mode-pill ' + (mode === 'owner' ? 'owner-pill' : 'staff-pill');
  buildNav();
  goScreen('dashboard');
  updateRatesPreview();
}

function doLogout() {
  mode = null;
  document.getElementById('app-shell').style.display = 'none';
  document.getElementById('login-screen').style.display = 'flex';
  document.getElementById('pass-input').value = '';
  document.getElementById('err-text').textContent = '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildNav() {
  const allNav = [
    { id: 'dashboard', label: 'Home', icon: 'âŒ‚' },
    { id: 'lookup', label: 'Lookup', icon: 'â—' },
    { id: 'billing', label: 'Billing', icon: 'âŠŸ' },
    { id: 'inventory', label: 'Inventory', icon: 'â—ˆ', ow: true },
    { id: 'rates', label: 'Rates', icon: 'â—†', ow: true },
    { id: 'reports', label: 'Reports', icon: 'â‰¡', ow: true },
  ];
  const nav = allNav.filter(n => !n.ow || mode === 'owner');
  document.getElementById('bottom-nav').innerHTML = nav.map(n =>
    `<button class="nav-btn" id="nav-${n.id}" onclick="goScreen('${n.id}')">
      <span class="nav-icon">${n.icon}</span>
      <span class="nav-label">${n.label}</span>
    </button>`
  ).join('');
}

function goScreen(id) {
  // Owner-only check
  const ownerOnly = ['inventory', 'rates', 'reports'];
  if (ownerOnly.includes(id) && mode !== 'owner') {
    id = id; // still go but show denied
  }
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + id)?.classList.add('active');
  document.getElementById('nav-' + id)?.classList.add('active');
  currentScreen = id;
  // scroll to top
  document.querySelector('.main-scroll').scrollTop = 0;

  if (id === 'dashboard') renderDashboard();
  if (id === 'lookup') { document.getElementById('lookup-input').value = ''; document.getElementById('lookup-result').innerHTML = ''; document.getElementById('lookup-drop').classList.remove('open'); }
  if (id === 'billing') renderBilling();
  if (id === 'inventory') { if (mode !== 'owner') { renderAccessDenied('inventory-content'); return; } renderInventoryList(); }
  if (id === 'rates') { if (mode !== 'owner') { document.getElementById('screen-rates').innerHTML = ''; renderAccessDeniedInto('screen-rates'); return; } }
  if (id === 'reports') { if (mode !== 'owner') { renderAccessDenied('screen-reports'); return; } renderReports(); }
}

function renderAccessDenied(containerId) {
  document.getElementById(containerId).innerHTML = `<div class="access-denied"><div class="denied-icon">ğŸ”’</div><h3 class="denied-title">Owner Access Required</h3><p class="denied-text">This section is restricted to the owner login only. Please exit and login with the owner password.</p><button class="btn-outline" onclick="goScreen('dashboard')">Go Back</button></div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
  const r = calcRates(rates.gold24);
  const items = Object.values(inventory);
  const salesArr = Object.values(sales);

  // Rates banner
  const ratesDiv = document.getElementById('dash-rates-banner');
  if (rates.gold24 > 0) {
    ratesDiv.style.display = '';
    document.getElementById('dash-warn').style.display = 'none';
    const rateList = [['24kt', r.r24], ['22kt', r.r22], ['18kt', r.r18], ['14kt', r.r14], ['Silver', rates.silver]];
    ratesDiv.innerHTML = rateList.map(([l, v]) => `<div class="rc"><div class="rc-label">${l}</div><div class="rc-val">${v > 0 ? inr(v) : 'â€”'}</div></div>`).join('');
  } else {
    ratesDiv.style.display = 'none';
    document.getElementById('dash-warn').style.display = mode === 'owner' ? '' : 'none';
  }

  const statsDiv = document.getElementById('dash-stats');
  const stockDiv = document.getElementById('dash-stock');

  if (mode === 'owner') {
    statsDiv.style.display = '';
    stockDiv.style.display = '';
    const today = new Date().toDateString();
    const todayRev = salesArr.filter(s => new Date(s.date).toDateString() === today).reduce((a, s) => a + (s.total || 0), 0);
    const totalGw = items.reduce((a, i) => a + (parseFloat(i.gw) || 0), 0).toFixed(2);
    statsDiv.innerHTML = [['â—ˆ', items.length, 'Items'], ['âŠ', totalGw + 'g', 'Total Wt'], ['â‚¹', inr(todayRev), "Today"]].map(([ic, v, l]) =>
      `<div class="stat-card"><div class="stat-icon">${ic}</div><div class="stat-val">${v}</div><div class="stat-lbl">${l}</div></div>`
    ).join('');

    const catMap = {};
    items.forEach(i => { if (!catMap[i.category]) catMap[i.category] = { p: 0, g: 0 }; catMap[i.category].p++; catMap[i.category].g += parseFloat(i.gw) || 0; });
    const tbody = document.querySelector('#dash-stock-table tbody');
    if (Object.keys(catMap).length === 0) {
      tbody.innerHTML = '<tr><td colspan="3" style="text-align:center;color:#CCC;padding:12px;">No inventory yet</td></tr>';
    } else {
      tbody.innerHTML = Object.entries(catMap).map(([c, v]) => `<tr><td>${c}</td><td>${v.p}</td><td>${v.g.toFixed(2)}</td></tr>`).join('');
    }
  } else {
    statsDiv.style.display = 'none';
    stockDiv.style.display = 'none';
  }

  const quickActions = [
    { ic: 'â—', l: 'Tag Lookup', sc: 'lookup' },
    { ic: 'âŠŸ', l: 'Billing', sc: 'billing' },
    ...(mode === 'owner' ? [{ ic: 'â—ˆ', l: 'Inventory', sc: 'inventory' }, { ic: 'â‰¡', l: 'Reports', sc: 'reports' }] : [])
  ];
  document.getElementById('dash-quick').innerHTML = quickActions.map(b =>
    `<button class="quick-btn" onclick="goScreen('${b.sc}')"><span>${b.ic}</span><span>${b.l}</span></button>`
  ).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LOOKUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function lookupAC() {
  const q = document.getElementById('lookup-input').value.trim().toLowerCase();
  const drop = document.getElementById('lookup-drop');
  document.getElementById('lookup-result').innerHTML = '';
  if (q.length < 2) { drop.classList.remove('open'); return; }
  const matches = Object.entries(inventory).filter(([k, i]) => i.tag.toLowerCase().includes(q)).slice(0, 8);
  if (matches.length === 0) { drop.classList.remove('open'); return; }
  drop.innerHTML = matches.map(([k, i]) =>
    `<div class="ac-item" onclick="selectLookupItem('${k}')">
      ${i.photo ? `<img class="ac-thumb" src="${i.photo}" alt=""/>` : ''}
      <div><span class="ac-tag">${i.tag}</span> <span class="ac-name">${i.name} Â· ${i.type}</span></div>
    </div>`
  ).join('');
  drop.classList.add('open');
}

function selectLookupItem(key) {
  const item = inventory[key];
  document.getElementById('lookup-input').value = item.tag;
  document.getElementById('lookup-drop').classList.remove('open');
  renderLookupResult(null, item);
}

function renderLookupResult(q, item) {
  if (!item && q) {
    const match = Object.values(inventory).find(i => i.tag.toLowerCase() === q.toLowerCase());
    if (!match) return;
    item = match;
  }
  if (!item) return;
  const pricing = calcPrice(item);
  const div = document.getElementById('lookup-result');
  div.innerHTML = `
    <div class="card">
      <div style="display:flex;gap:12px;align-items:flex-start;margin-bottom:12px;">
        ${item.photo ? `<img src="${item.photo}" style="width:84px;height:84px;object-fit:cover;border-radius:10px;border:1px solid var(--border);flex-shrink:0;" alt=""/>` : ''}
        <div style="flex:1;">
          <div class="bold" style="font-size:16px;color:var(--dark);">${item.name}</div>
          <div class="text-gold bold" style="font-size:13px;margin-bottom:2px;">${item.tag}</div>
          <div class="text-muted" style="font-size:12px;">${item.category} Â· ${item.type}</div>
          <div style="font-size:12px;color:var(--mid);">GW: ${item.gw}g${item.nw && item.nw != item.gw ? ` Â· NW: ${item.nw}g` : ''}</div>
          ${item.notes ? `<div style="font-size:11px;color:var(--muted);margin-top:3px;font-style:italic;">${item.notes}</div>` : ''}
        </div>
      </div>
      <div class="divider-gold" style="margin:0 0 12px;"></div>
      ${pricing ? `
        <div class="flex-between" style="padding:4px 0;">
          <span style="font-size:14px;color:var(--mid);">Total Price</span>
          <span class="serif bold" style="font-size:22px;color:var(--gold);">${inr(pricing.total)}</span>
        </div>
        <button class="btn-outline full-width mt12" onclick="openCustomerView('${Object.keys(inventory).find(k=>inventory[k].tag===item.tag)}')">
          Show Customer Price Breakdown â†—
        </button>
      ` : `<p style="color:#8A6A0A;font-size:13px;text-align:center;">Rates not set. Contact owner.</p>`}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CUSTOMER FULLSCREEN VIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openCustomerView(key) {
  const item = inventory[key];
  if (!item) return;
  const pricing = calcPrice(item);
  if (!pricing) { notify('Rates not set', true); return; }
  const gl = item.type.startsWith('22') ? '22kt' : item.type.startsWith('18') ? '18kt' : '14kt';
  const isPlain = item.type === '22kt Plain';

  document.getElementById('cv-body').innerHTML = `
    ${item.photo ? `<img class="cv-product-img" src="${item.photo}" alt="${item.name}"/>` : ''}
    <div class="cv-product-name">${item.name}</div>
    <div class="cv-product-tag">${item.tag}</div>
    <div class="cv-product-meta">${item.category} Â· ${item.type} Â· GW: ${item.gw}g${item.nw && item.nw != item.gw ? ` Â· NW: ${item.nw}g` : ''}</div>

    <div class="cv-section">
      <div class="cv-section-title">Gold Details</div>
      <div class="cv-row"><span class="cv-row-label">${gl} Gold Rate (Today)</span><span class="cv-row-val">${inr(pricing.goldRate)}/g</span></div>
      <div class="cv-row"><span class="cv-row-label">Polish Charges</span><span class="cv-row-val">${item.polishPct || 0}% on ${isPlain ? 'gross' : 'net'} weight</span></div>
      <div class="cv-row"><span class="cv-row-label">Billable Gold Weight</span><span class="cv-row-val">${pricing.billW.toFixed(3)}g</span></div>
      <div class="cv-row"><span class="cv-row-label">Gold Value</span><span class="cv-row-val bold text-gold">${inr(pricing.goldVal)}</span></div>
    </div>

    <div class="cv-section">
      <div class="cv-section-title">Making & Other Charges</div>
      <div class="cv-row"><span class="cv-row-label">Making Charges</span><span class="cv-row-val">${inr(item.makingPG || 0)}/g Ã— ${item.gw}g</span></div>
      <div class="cv-row"><span class="cv-row-label">Making Amount</span><span class="cv-row-val bold">${inr(pricing.making)}</span></div>
      ${pricing.stoneVal > 0 ? `<div class="cv-row"><span class="cv-row-label">Stone Charges</span><span class="cv-row-val bold">${inr(pricing.stoneVal)}</span></div>` : ''}
      ${pricing.diamVal > 0 ? `
        <div class="cv-row"><span class="cv-row-label">Diamond Charges</span><span class="cv-row-val">${inr(item.diamondChg || 0)}/ct Ã— ${item.diamondCt}ct</span></div>
        <div class="cv-row"><span class="cv-row-label">Diamond Amount</span><span class="cv-row-val bold">${inr(pricing.diamVal)}</span></div>
      ` : ''}
    </div>

    <div class="cv-total-box">
      <div class="cv-total-label">TOTAL PRICE</div>
      <div class="cv-total-amount">${inr(pricing.total)}</div>
    </div>
  `;
  document.getElementById('customer-view').classList.add('open');
  document.getElementById('customer-view').scrollTop = 0;
}

function closeCustomerView() {
  document.getElementById('customer-view').classList.remove('open');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BILLING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let billDone = null;

function renderBilling() {
  if (billDone) { renderBillSuccess(); return; }
  const cartHTML = billingCart.length === 0 ? '' : billingCart.map((item, idx) => {
    const p = calcPrice(item);
    return `<div class="inv-card" style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <div class="inv-name">${item.name}</div>
        <div class="inv-tag">${item.tag} Â· ${item.gw}g</div>
      </div>
      <div style="display:flex;align-items:center;gap:10px;">
        <span class="inv-price">${p ? inr(p.total) : 'â€”'}</span>
        <button onclick="removeFromCart(${idx})" style="background:none;border:none;color:var(--red);font-size:20px;cursor:pointer;">Ã—</button>
      </div>
    </div>`;
  }).join('');

  const grand = billingCart.reduce((a, i) => a + (calcPrice(i)?.total || 0), 0);

  document.getElementById('billing-content').innerHTML = `
    <input class="fi" id="bill-cust-name" placeholder="Customer Name *"/>
    <input class="fi" id="bill-phone" placeholder="Phone Number (optional)" style="margin-top:6px;"/>
    <div class="ac-wrap mt12">
      <input class="fi" id="bill-search" placeholder="Search tag to add itemsâ€¦" oninput="billAC()" autocomplete="off" style="margin-bottom:0;"/>
      <div class="ac-drop" id="bill-drop"></div>
    </div>
    ${cartHTML}
    ${billingCart.length > 0 ? `
      <div class="card">
        <div class="flex-between" style="padding:8px 0;">
          <span class="bold" style="font-size:15px;">Grand Total</span>
          <span class="serif bold text-gold" style="font-size:20px;">${inr(grand)}</span>
        </div>
        <button class="btn-gold full-width mt8" onclick="generateBill()" style="padding:13px;">Generate Bill</button>
      </div>
    ` : ''}`;
}

function billAC() {
  const q = document.getElementById('bill-search').value.trim().toLowerCase();
  const drop = document.getElementById('bill-drop');
  if (q.length < 2) { drop.classList.remove('open'); return; }
  const inCartTags = billingCart.map(i => i.tag);
  const matches = Object.entries(inventory).filter(([k, i]) => i.tag.toLowerCase().includes(q) && !inCartTags.includes(i.tag)).slice(0, 6);
  if (!matches.length) { drop.classList.remove('open'); return; }
  drop.innerHTML = matches.map(([k, i]) =>
    `<div class="ac-item" onclick="addToCart('${k}')">
      ${i.photo ? `<img class="ac-thumb" src="${i.photo}" alt=""/>` : ''}
      <span class="ac-tag">${i.tag}</span><span class="ac-name">${i.name} Â· ${i.gw}g</span>
    </div>`
  ).join('');
  drop.classList.add('open');
}

function addToCart(key) {
  billingCart.push(inventory[key]);
  renderBilling();
}

function removeFromCart(idx) {
  billingCart.splice(idx, 1);
  renderBilling();
}

function generateBill() {
  const name = document.getElementById('bill-cust-name').value.trim();
  const phone = document.getElementById('bill-phone').value.trim();
  if (!name) { notify('Enter customer name', true); return; }
  if (billingCart.length === 0) { notify('Add at least one item', true); return; }
  const grand = billingCart.reduce((a, i) => a + (calcPrice(i)?.total || 0), 0);
  const bill = {
    date: new Date().toISOString(),
    customer: name, phone,
    items: billingCart.map(i => ({ tag: i.tag, name: i.name, total: calcPrice(i)?.total || 0 })),
    total: grand
  };
  dbPush('sales', bill).then(() => {
    billDone = bill;
    billingCart = [];
    renderBillSuccess();
    notify('Bill generated!');
  });
}

function renderBillSuccess() {
  document.getElementById('billing-content').innerHTML = `
    <div class="bill-success">
      <div class="success-check">âœ“</div>
      <h3 class="serif" style="font-size:22px;color:var(--dark);">Bill Generated!</h3>
      <div style="color:var(--muted);font-size:13px;margin:6px 0;">${billDone.customer}${billDone.phone ? ' Â· ' + billDone.phone : ''}</div>
      <div class="success-amount">${inr(billDone.total)}</div>
      <div class="card" style="text-align:left;">
        ${billDone.items.map(it => `<div class="flex-between" style="padding:5px 0;border-bottom:1px dotted var(--border);font-size:13px;"><span>${it.tag} â€” ${it.name}</span><span class="bold text-gold">${inr(it.total)}</span></div>`).join('')}
      </div>
      <button class="btn-gold" style="padding:13px 32px;font-size:15px;" onclick="billDone=null;renderBilling();">New Bill</button>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INVENTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let invSearch = '', invFilter = 'All';

function renderInventoryList() {
  const items = Object.entries(inventory).filter(([k, i]) => {
    const ms = i.tag.toLowerCase().includes(invSearch.toLowerCase()) || i.name.toLowerCase().includes(invSearch.toLowerCase());
    return ms && (invFilter === 'All' || i.type === invFilter);
  });

  document.getElementById('inventory-content').innerHTML = `
    <div class="flex-between" style="margin-bottom:12px;">
      <h2 class="page-title mb0">Inventory</h2>
      <button class="btn-gold" onclick="goAddItem(null)" style="padding:9px 16px;font-size:13px;">+ Add</button>
    </div>
    <input class="fi" placeholder="Search tag or nameâ€¦" oninput="invSearch=this.value;renderInventoryList()" value="${invSearch}"/>
    <div class="chips mt8">
      ${['All', ...TYPES].map(t => `<button class="chip${invFilter === t ? ' active' : ''}" onclick="invFilter='${t}';renderInventoryList()">${t}</button>`).join('')}
    </div>
    <div style="font-size:12px;color:var(--muted);margin-bottom:8px;">${items.length} item${items.length !== 1 ? 's' : ''}</div>
    ${items.length === 0 ? `<div class="empty-state"><div class="empty-icon">â—ˆ</div><p>No items found</p></div>` :
      items.map(([k, item]) => {
        const p = calcPrice(item);
        return `<div class="inv-card">
          <div style="display:flex;gap:10px;">
            ${item.photo ? `<img src="${item.photo}" class="inv-photo" alt=""/>` : ''}
            <div style="flex:1;min-width:0;">
              <div class="flex-between">
                <div style="min-width:0;flex:1;">
                  <div class="inv-name" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${item.name}</div>
                  <div class="inv-tag">${item.tag}</div>
                  <div class="inv-meta">${item.type} Â· ${item.category} Â· GW:${item.gw}g${item.nw && item.nw != item.gw ? ` NW:${item.nw}g` : ''}</div>
                </div>
                ${p ? `<div class="inv-price" style="margin-left:8px;flex-shrink:0;">${inr(p.total)}</div>` : ''}
              </div>
            </div>
          </div>
          <div style="display:flex;gap:8px;margin-top:10px;">
            <button class="btn-outline" style="flex:1;padding:7px 0;font-size:12px;" onclick="goAddItem('${k}')">Edit</button>
            <button class="btn-danger" style="flex:1;padding:7px 0;font-size:12px;" onclick="deleteItem('${k}','${item.name}')">Delete</button>
          </div>
        </div>`;
      }).join('')
    }`;
}

function deleteItem(key, name) {
  if (!confirm('Delete "' + name + '"?')) return;
  dbRemove('inventory/' + key).then(() => notify('Deleted'));
}

function goAddItem(key) {
  editingItemKey = key;
  renderAddItemForm(key ? inventory[key] : null);
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-add-item').classList.add('active');
  currentScreen = 'add-item';
  document.querySelector('.main-scroll').scrollTop = 0;
}

function renderAddItemForm(item) {
  const isEdit = !!item;
  const t = item?.type || TYPES[0];
  const isDia = t === '18kt Diamond' || t === '14kt Diamond';
  const isSt = t === '22kt Stone';
  const gw = parseFloat(item?.gw) || 0;
  const dCt = parseFloat(item?.diamondCt) || 0;
  const sCt = parseFloat(item?.stoneCt) || 0;
  const nw = isDia ? calcNW(gw, dCt, sCt) : gw;

  document.getElementById('add-item-content').innerHTML = `
    <div class="flex-between" style="margin-bottom:14px;">
      <h2 class="page-title mb0">${isEdit ? 'Edit Item' : 'Add Item'}</h2>
      <button onclick="goScreen('inventory')" style="background:none;border:1px solid #DDD;border-radius:6px;padding:5px 12px;font-size:12px;cursor:pointer;color:#999;">Cancel</button>
    </div>
    <div class="card">
      <label class="fl">Tag Number *</label>
      <input class="fi" id="ai-tag" value="${item?.tag || ''}" placeholder="e.g. RGS-01-12" oninput="this.value=this.value.toUpperCase()"/>
      <label class="fl">Product Name *</label>
      <input class="fi" id="ai-name" value="${item?.name || ''}" placeholder="e.g. Ladies Gold Ring"/>
      <label class="fl">Category</label>
      <select class="fi" id="ai-cat">${CATS.map(c => `<option${item?.category === c ? ' selected' : ''}>${c}</option>`).join('')}</select>
      <label class="fl">Jewellery Type</label>
      <select class="fi" id="ai-type" onchange="onTypeChange()">${TYPES.map(tp => `<option${item?.type === tp ? ' selected' : ''}>${tp}</option>`).join('')}</select>
      <label class="fl">Gross Weight (g) *</label>
      <input class="fi" type="number" id="ai-gw" value="${item?.gw || ''}" placeholder="10.5" oninput="onWeightChange()"/>

      <div id="ai-diamond-fields" style="${isDia ? '' : 'display:none;'}">
        <label class="fl">Diamond Weight (ct)</label>
        <input class="fi" type="number" id="ai-dct" value="${item?.diamondCt || ''}" placeholder="0.00" oninput="onWeightChange()"/>
        <label class="fl">Stone Weight (ct) â€” if any</label>
        <input class="fi" type="number" id="ai-sct" value="${item?.stoneCt || ''}" placeholder="0.00" oninput="onWeightChange()"/>
        <div class="nw-box" id="ai-nw-box">Auto Net Weight: <strong id="ai-nw-val">${nw}g</strong><span style="font-size:11px;color:var(--muted);margin-left:6px;">(ct â†’ g deducted)</span></div>
      </div>

      <div id="ai-stone-fields" style="${isSt ? '' : 'display:none;'}">
        <label class="fl">Stone Weight (ct)</label>
        <input class="fi" type="number" id="ai-sct2" value="${item?.stoneCt || ''}" placeholder="0.00"/>
      </div>

      <div style="height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:12px 0 2px;"></div>
      <div style="font-size:10px;color:var(--muted);letter-spacing:1px;margin-bottom:4px;">CHARGES</div>

      <label class="fl">Polish % (on <span id="ai-polish-on">${isDia || isSt ? 'net' : 'gross'}</span> weight)</label>
      <input class="fi" type="number" id="ai-polish" value="${item?.polishPct ?? 10}" placeholder="10"/>
      <label class="fl">Making Charges (â‚¹/g on gross weight)</label>
      <input class="fi" type="number" id="ai-making" value="${item?.makingPG ?? 230}" placeholder="230"/>

      <div id="ai-stone-chg" style="${isSt ? '' : 'display:none;'}">
        <label class="fl">Stone Charges (â‚¹/gram)</label>
        <input class="fi" type="number" id="ai-stchg" value="${item?.stoneChg || 0}"/>
      </div>

      <div id="ai-diamond-chg" style="${isDia ? '' : 'display:none;'}">
        <label class="fl">Diamond Charges (â‚¹/carat)</label>
        <input class="fi" type="number" id="ai-dchg" value="${item?.diamondChg || 0}"/>
        <div id="ai-stone-chg2" style="${sCt > 0 ? '' : 'display:none;'}">
          <label class="fl">Stone Charges (â‚¹/carat)</label>
          <input class="fi" type="number" id="ai-stchg2" value="${item?.stoneChg || 0}"/>
        </div>
      </div>

      <div style="height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:12px 0 2px;"></div>
      <label class="fl">Product Photo</label>
      <input type="file" accept="image/*" onchange="handlePhoto(event)" style="font-size:12px;margin-bottom:6px;"/>
      ${item?.photo ? `<img src="${item.photo}" id="ai-photo-preview" style="width:90px;height:90px;object-fit:cover;border-radius:8px;border:1px solid var(--border);display:block;margin-bottom:6px;"/>` : `<img id="ai-photo-preview" style="width:90px;height:90px;object-fit:cover;border-radius:8px;border:1px solid var(--border);display:none;margin-bottom:6px;"/>`}

      <label class="fl">Notes</label>
      <textarea class="fi" id="ai-notes" placeholder="Any additional notes">${item?.notes || ''}</textarea>

      <button class="btn-gold full-width mt12" onclick="saveItem()" style="padding:13px;">${isEdit ? 'Update Item' : 'Save Item'}</button>
    </div>`;
  window._photoData = item?.photo || null;
}

function onTypeChange() {
  const t = document.getElementById('ai-type').value;
  const isDia = t === '18kt Diamond' || t === '14kt Diamond';
  const isSt = t === '22kt Stone';
  document.getElementById('ai-diamond-fields').style.display = isDia ? '' : 'none';
  document.getElementById('ai-stone-fields').style.display = isSt ? '' : 'none';
  document.getElementById('ai-stone-chg').style.display = isSt ? '' : 'none';
  document.getElementById('ai-diamond-chg').style.display = isDia ? '' : 'none';
  const polishOnEl = document.getElementById('ai-polish-on');
  if (polishOnEl) polishOnEl.textContent = isDia || isSt ? 'net' : 'gross';
  onWeightChange();
}

function onWeightChange() {
  const t = document.getElementById('ai-type')?.value;
  const isDia = t === '18kt Diamond' || t === '14kt Diamond';
  if (!isDia) return;
  const gw = parseFloat(document.getElementById('ai-gw')?.value) || 0;
  const dCt = parseFloat(document.getElementById('ai-dct')?.value) || 0;
  const sCt = parseFloat(document.getElementById('ai-sct')?.value) || 0;
  const nw = calcNW(gw, dCt, sCt);
  const el = document.getElementById('ai-nw-val');
  if (el) el.textContent = nw + 'g';
  // Show/hide stone charges in diamond
  const s2 = document.getElementById('ai-stone-chg2');
  if (s2) s2.style.display = sCt > 0 ? '' : 'none';
}

function handlePhoto(e) {
  const f = e.target.files[0];
  if (!f) return;
  // Compress photo
  const reader = new FileReader();
  reader.onload = ev => {
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      const MAX = 600;
      let w = img.width, h = img.height;
      if (w > MAX) { h = h * MAX / w; w = MAX; }
      if (h > MAX) { w = w * MAX / h; h = MAX; }
      canvas.width = w; canvas.height = h;
      canvas.getContext('2d').drawImage(img, 0, 0, w, h);
      const data = canvas.toDataURL('image/jpeg', 0.7);
      window._photoData = data;
      const preview = document.getElementById('ai-photo-preview');
      preview.src = data;
      preview.style.display = 'block';
    };
    img.src = ev.target.result;
  };
  reader.readAsDataURL(f);
}

function saveItem() {
  const tag = document.getElementById('ai-tag').value.trim().toUpperCase();
  const name = document.getElementById('ai-name').value.trim();
  const gw = parseFloat(document.getElementById('ai-gw').value) || 0;
  if (!tag || !name || !gw) { notify('Tag, Name & Weight required', true); return; }
  const type = document.getElementById('ai-type').value;
  const isDia = type === '18kt Diamond' || type === '14kt Diamond';
  const isSt = type === '22kt Stone';
  const dCt = parseFloat(document.getElementById('ai-dct')?.value) || 0;
  const sCt = isDia ? (parseFloat(document.getElementById('ai-sct')?.value) || 0) : (parseFloat(document.getElementById('ai-sct2')?.value) || 0);
  const nw = isDia ? calcNW(gw, dCt, sCt) : gw;

  const item = {
    tag, name, gw, nw,
    category: document.getElementById('ai-cat').value,
    type,
    diamondCt: dCt,
    stoneCt: sCt,
    polishPct: parseFloat(document.getElementById('ai-polish').value) || 0,
    makingPG: parseFloat(document.getElementById('ai-making').value) || 0,
    stoneChg: isSt ? (parseFloat(document.getElementById('ai-stchg').value) || 0) : (isDia ? (parseFloat(document.getElementById('ai-stchg2')?.value) || 0) : 0),
    diamondChg: isDia ? (parseFloat(document.getElementById('ai-dchg').value) || 0) : 0,
    photo: window._photoData || '',
    notes: document.getElementById('ai-notes').value.trim(),
  };

  const path = editingItemKey ? 'inventory/' + editingItemKey : 'inventory/' + Date.now();
  dbSet(path, item).then(() => {
    notify(editingItemKey ? 'Item updated!' : 'Item saved!');
    editingItemKey = null;
    goScreen('inventory');
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RATES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('rate-gold24').addEventListener('input', updateRatesPreview);

function updateRatesPreview() {
  const g = parseFloat(document.getElementById('rate-gold24').value) || 0;
  const prev = document.getElementById('rates-preview');
  if (!prev) return;
  if (g > 0) {
    const r = calcRates(g);
    prev.style.display = '';
    document.getElementById('rates-preview-grid').innerHTML = [['22kt', r.r22, '94.5%'], ['18kt', r.r18, '78.5%'], ['14kt', r.r14, '62%']].map(([l, v, p]) =>
      `<div style="text-align:center;background:#fff;border-radius:8px;padding:8px 4px;border:1px solid var(--border);"><div style="font-size:9px;color:var(--muted);margin-bottom:2px;">${l}</div><div style="font-weight:700;color:var(--dark);font-size:13px;">${inr(v)}</div><div style="font-size:9px;color:var(--muted);">${p}</div></div>`
    ).join('');
  } else { prev.style.display = 'none'; }
}

function saveRates() {
  const g24 = parseFloat(document.getElementById('rate-gold24').value) || 0;
  const silver = parseFloat(document.getElementById('rate-silver').value) || 0;
  if (!g24) { notify('Enter 24kt gold rate', true); return; }
  dbSet('rates', { gold24: g24, silver }).then(() => {
    const btn = document.getElementById('save-rates-btn');
    btn.textContent = 'âœ“ Saved & Synced';
    btn.style.background = 'var(--green)';
    setTimeout(() => { btn.textContent = 'Save Rates'; btn.style.background = ''; }, 3000);
    notify('Rates saved & synced!');
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  REPORTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initReportPeriods() {
  document.getElementById('period-btns').innerHTML = PERIODS.map(p =>
    `<button class="period-btn${reportPeriod === p ? ' active' : ''}" onclick="reportPeriod='${p}';initReportPeriods();renderReports();">${p.charAt(0).toUpperCase() + p.slice(1)}</button>`
  ).join('');
}

function inPeriod(dateStr) {
  const d = new Date(dateStr), now = new Date();
  if (reportPeriod === 'daily') return d.toDateString() === now.toDateString();
  if (reportPeriod === 'weekly') { const df = (now - d) / 864e5; return df >= 0 && df < 7; }
  if (reportPeriod === 'monthly') return d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear();
  if (reportPeriod === 'quarterly') { return Math.floor(d.getMonth() / 3) === Math.floor(now.getMonth() / 3) && d.getFullYear() === now.getFullYear(); }
  return d.getFullYear() === now.getFullYear();
}

function renderReports() {
  initReportPeriods();
  const salesArr = Object.values(sales).filter(s => inPeriod(s.date));
  const rev = salesArr.reduce((a, s) => a + (s.total || 0), 0);
  const items = Object.values(inventory);
  const cm = {};
  items.forEach(i => { if (!cm[i.type]) cm[i.type] = { p: 0, g: 0, v: 0 }; cm[i.type].p++; cm[i.type].g += parseFloat(i.gw) || 0; if (rates.gold24 > 0) cm[i.type].v += calcPrice(i)?.total || 0; });

  document.getElementById('reports-content').innerHTML = `
    <div class="card">
      <div class="card-title">Sales â€” ${reportPeriod.charAt(0).toUpperCase() + reportPeriod.slice(1)}</div>
      <div class="pr"><span class="pr-label">Bills Generated</span><span class="pr-val bold">${salesArr.length}</span></div>
      <div class="pr" style="border-bottom:none;"><span class="pr-label">Total Revenue</span><span class="serif bold text-gold" style="font-size:18px;">${inr(rev)}</span></div>
      <div style="max-height:220px;overflow-y:auto;margin-top:8px;">
        ${salesArr.slice().reverse().slice(0, 30).map(s => `
          <div style="border-top:1px solid #F8F0E0;padding:7px 0;">
            <div class="flex-between" style="font-size:13px;"><span class="bold">${s.customer}${s.phone ? ` (${s.phone})` : ''}</span><span class="text-gold bold">${inr(s.total)}</span></div>
            <div style="font-size:11px;color:var(--muted);">${new Date(s.date).toLocaleString()}</div>
          </div>`).join('')}
        ${salesArr.length === 0 ? '<p style="text-align:center;color:#CCC;padding:12px;font-size:13px;">No sales in this period</p>' : ''}
      </div>
    </div>
    <div class="card">
      <div class="card-title">Stock Value by Type</div>
      ${Object.entries(cm).map(([type, v]) => `
        <div style="border-bottom:1px solid #F8F0E0;padding:8px 0;">
          <div class="flex-between" style="font-size:13px;"><span class="bold">${type}</span><span class="text-gold bold">${rates.gold24 > 0 ? inr(v.v) : 'Set rates'}</span></div>
          <div style="font-size:11px;color:var(--muted);">${v.p} pieces Â· ${v.g.toFixed(2)}g</div>
        </div>`).join('')}
      ${Object.keys(cm).length === 0 ? '<p style="text-align:center;color:#CCC;padding:12px;font-size:13px;">No inventory</p>' : ''}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FIREBASE NOT CONFIGURED BANNER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function checkFirebaseConfig() {
  const apiKey = document.querySelector('script[type="module"]')?.innerHTML?.includes('FIREBASE_CONFIGURED');
  return !apiKey;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('DOMContentLoaded', () => {
  initFirebase();
  // Show login after brief load
  setTimeout(() => {
    document.getElementById('loading').style.display = 'none';
    const configured = checkFirebaseConfig();
    if (!configured) {
      // Show setup guide instead
      document.getElementById('login-screen').style.display = 'none';
      showSetupGuide();
    } else {
      document.getElementById('login-screen').style.display = 'flex';
    }
  }, 1200);
});

function showSetupGuide() {
  document.body.innerHTML = `
  <div style="min-height:100vh;background:linear-gradient(155deg,#FDFAF3,#F7EDD5,#EFE0C0);padding:24px;font-family:'DM Sans',sans-serif;max-width:480px;margin:0 auto;">
    <div style="text-align:center;margin-bottom:24px;">
      <div style="width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,#B8960C,#E8C840);display:flex;align-items:center;justify-content:center;margin:0 auto 14px;font-size:28px;color:#fff;box-shadow:0 4px 18px rgba(184,150,12,0.3);">âœ¦</div>
      <h1 style="font-family:'Cormorant Garamond',serif;font-size:26px;color:#1C1205;margin-bottom:4px;">Gayatri Jewellers</h1>
      <p style="font-size:10px;color:#B8960C;letter-spacing:4px;">SETUP REQUIRED</p>
    </div>
    <div style="background:#fff;border-radius:16px;padding:20px;border:1px solid #E8D898;margin-bottom:16px;">
      <h3 style="font-family:'Cormorant Garamond',serif;font-size:18px;color:#1C1205;margin-bottom:14px;">One-Time Setup (10 minutes)</h3>
      <p style="font-size:13px;color:#6B5030;margin-bottom:14px;line-height:1.6;">You need a free Firebase account to sync data across all your phones. No credit card needed.</p>

      <div style="display:flex;gap:10px;margin-bottom:12px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">1</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">Go to <strong>console.firebase.google.com</strong> â†’ Sign in with Google (free)</div>
      </div>
      <div style="display:flex;gap:10px;margin-bottom:12px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">2</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">Click <strong>Add project</strong> â†’ Name it "gayatri-jewellers" â†’ Click Continue</div>
      </div>
      <div style="display:flex;gap:10px;margin-bottom:12px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">3</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">Click the <strong>Web icon (&lt;/&gt;)</strong> â†’ Register app â†’ Copy the firebaseConfig object</div>
      </div>
      <div style="display:flex;gap:10px;margin-bottom:12px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">4</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">In Firebase â†’ <strong>Build â†’ Realtime Database</strong> â†’ Create database â†’ Start in test mode</div>
      </div>
      <div style="display:flex;gap:10px;margin-bottom:12px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">5</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">Open this HTML file in a text editor â†’ Find <strong>AIzaSyD8qXLnILIfXGN8Z7POPAS9TngdTAgoKT8</strong> â†’ Replace entire firebaseConfig with yours â†’ Save</div>
      </div>
      <div style="display:flex;gap:10px;">
        <div style="background:#B8960C;color:#fff;border-radius:50%;width:26px;height:26px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0;">6</div>
        <div style="font-size:13px;color:#3D2A0E;line-height:1.5;">Go to <strong>github.com</strong> â†’ Create free account â†’ New repository â†’ Upload this HTML file â†’ Enable GitHub Pages â†’ Your app is live forever, free!</div>
      </div>
    </div>
    <div style="background:#FDF6DC;border:1px solid #E8C840;border-radius:12px;padding:14px;text-align:center;">
      <p style="font-size:12px;color:#8A6A0A;line-height:1.6;margin:0;">ğŸ’¡ <strong>Once set up:</strong> Open your GitHub Pages URL on any phone, login, and everything syncs live â€” inventory, rates, sales â€” across all your devices 24/7, completely free, forever.</p>
    </div>
  </div>`;
}

// Close AC dropdowns on outside click
document.addEventListener('click', e => {
  if (!e.target.closest('.ac-wrap')) {
    document.querySelectorAll('.ac-drop').forEach(d => d.classList.remove('open'));
  }
});
</script>
</body>
</html>
